---
layout: post
title:  "엔터프라이즈 애플리케이션 아키텍처 패턴(PoEAA) 1"
author: Aeee
date:   2021-10-13 14:29:49 +0900
categories: GOF
tags: PoEAA Layer
image: /assets/images/PoEAA.png
---

# 계층화 (Layering)
계층화(layering)는 소프트웨어 설계자가 복잡한 소프트웨어 시스템을 분할하는 데 사용하는 가장 일반적인 기법이다.
시스템을 계층으로 분할하면 다음과 같은 이점이 있다.

- 다른 계층에 대한 정보 없이도 단일 계층을 하나의 일관된 계층으로 이해할 수 있다. 예를 들어, 이더넷이 작동하는 방법을
모르더라도 TCP 기반의 FTP 서비스를 구축할 수 있다.
- 동일한 기본 서비스를 가진 대안 구현으로 계층을 대체할 수 있다. FTP 서비스는 이더넷, PPP 또는 케이블 회사에서
제공하는 다른 포로토콜 기반에서 변경 없이 작동할 수 있다.
- 계층 간의 의존성을 최소화할 수 있다. 케이블 회사에서 물리 전송 시스템을 교체하더라도 IP만 작동 작동하면 FTP
서비스를 변경할 필요가 없다.
- 계층은 표준화하기 좋은 위치다. TCP와 IP는 해당 계층이 작동하는 위치를 정의하기 때문에 표준이 됐다.
- 한 번 구축한 계층은 여러 다른 상위 서비스에서 사용할 수 있다. 예를 들어, TCP/IP는 FTP, 텔넷, SSH, HTTP
에서 사용된다. TCP/IP가 없었다면 모든 상위 프로토콜에서 사실상 동일한 하위 프로토콜을 일일이 다시 구축해야 할 것이다.

계층화는 중요한 기법이지만 단점이 있다.
- 계층은 전체가 효과적으로 캡슐화 되지 않는다. 계층형 엔터프라이즈 애플리케이션에서 볼 수 있는 전형적인 예는 UI에
표시해야 하는 필드가 데이터 베이스에도 있어야 하므로 그 사이에 있는 모든 계층에 해당 필드를 추가해야 한다는 것이다.
- 계층을 추가하면 성능이 저하된다. 일반적으로 각 계층에서는 정보를 한 표현으로 변화해야 한다. 다만, 기반 기능을
캡슐화하면 성능 저하가 보상될 만큼 효율이 향상되는 경우도 많다. 예를 들어, 트랜잭션을 제어하는 계층을 최적화하면
애플리케이션 전체가 빨라지는 효과가 있다.

## 세가지 주요 계층

1. 프레젠테이션(presentation) 논리는 사용자와 소프트웨어 간 상호작용을 처리한다. 서비스 제공, 정보 표시, 사용자 요청
, HTTP 요청, 명령중 호출, 일괄작업 API 처리
2. 도메인 논리(domain logic)는 애플리케이션이 수행해야 하는 도메인과 관련된 작업이다. 시스템의 핵심이 되는 논리이다.
3. 데이터 원본(data source)는 애플리케이션을 대신해 다른 시스템과 통신한다. 데이터베이스, 메시징 시스템, 트랜잭션 관리자 및 다른 패키지와 통신한다.


# 도메인 논리 구성

도메인 논리를 트랜잭션 스크립트, 도메인 모델, 테이블 모듈 세가지 주요 패턴으로 분리했다.

트랜잭션 스크립트는 프레젠테이션에서 입력을 받고, 유효성 검사와 계산을 통해 입력을 처리한 다음, 데이터베이스에 데이터를
저장하고, 다른 시스템에서 작업을 호출하는 프로시저다. 이에는 여러 장점이 있다.

- 대부분 개발자가 이해할 수 있는 간단한 절차적인 모델이다.
- 행 데이터 게이트웨이 나 테이블 데이터 게이트웨이를 적용해 데이터 원본 계층과 함게 사용하기 적합하다.
- 트랜잭션의 경계를 설정하기가 쉽다. 트랜잭션 열기와 함꼐 시작하고 트랜잭션 닫기와 함꼐 종료한다. 툴을 사용해
배후에서 이러한 작업을 하기도 쉽다.

이에 단점도 많다. 도메인 논리가 늘어나면서 복잡도가 상승하는 결과로 주로 나타난다.

복잡한 논리는 객체를 통해 해결할 수 잇으며, 이 문제를 해결하기 위한 객체지향적 방법이 바로 도메인 모델이다.
도메인에 관련된 명사를 추출하여 클래스를 만들고, 각 도메인 로직을 클래스에게 위임하는 방식이다.

<img src="/assets/images/poeaa/2.1.jpg" style="width: 100%;" /><br/>

위 트랜잭션 스크립트에서는 메서드가 모든 일을 다한다. 기본 객체는 데이터를 트랜잭션 스크립트로 전달하는 테이블
데이터 게이트웨이가 전부다.

<img src="/assets/images/poeaa/2.2.jpg" style="width: 100%;" /><br/>

반면 위의 도메인 모델은 여러 객체가 있으며, 최종적으로 전략 객체가 결과를 내놓을 때까지 각 객체가 동작의 일부를 다음 객체로 전달한다.

<img src="/assets/images/poeaa/2.3.jpg" style="width: 100%;" /><br/>

테이블 모듈은 도메인 모듈과 비슷해 보인다. 여러 면에서 트랙잭션 스크립트와 도메인 모델의 중간적인 성격을 많이 띈다.


## 서비스 계층
도메인 논리를 처리하는 일반적인 방법은 도메인 계층을 둘로 나누는 것이다. 이 경우 서비스 계층을 기반이 되는
도메인 모델이나 테이블 모듈 위에 배치한다. 트랜잭션 스크립트만 사용하는 도메인 계층은 별도의 계층을 수용할 만큼
복잡하지 않기 때문에 일반적으로 이 구조는 도메인 모델이나 테이블 모듈에만 사용한다.